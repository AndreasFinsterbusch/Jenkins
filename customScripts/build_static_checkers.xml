<?xml version="1.0" encoding="UTF-8" ?>
<project name="catroid_static_code_analysis">	
	
	<!-- common properties -->
	<property name="job.workspace" value="${job.workspace}" />
	<property name="customscripts.home" value="${customscripts.home}" />
	<property name="android.sdk.platform" value="${android.sdk}/platforms" />
	<property name="android.sdk.version" value="android-15" />
	<property name="reports.dir" value="${job.workspace}/catroid/reports" />
	
	<!-- properties for findbugs -->
	<property name="findbugs.home" value="${findbugs.home}" />
	<property name="catroid.libs" value="${job.workspace}/catroid/libs" />
	<property name="catroid.excluded.classes" value="${job.workspace}/catroid/bin/classes/com" />
	<property name="catroid.classes" value="${job.workspace}/catroid/bin/classes/org/catrobat/catroid" />	
	<property name="abs.libs" value="${job.workspace}/libraryProjects/actionbarsherlock/libs" />
	<property name="abs.bin" value="${job.workspace}/libraryProjects/actionbarsherlock/bin" />	
	
	<!-- properties for checkstyls -->
	<property name="checkstyle.home" value="${checkstyle.home}" />
	<property name="catroid.source.dir" value="${job.workspace}/catroid/src" />
	
	<!-- taskdefs -->	
	<taskdef name="findbugs" classname="edu.umd.cs.findbugs.anttask.FindBugsTask" />
	
	<!-- TARGETS -->	
	
	<target name="findbugs">
		<mkdir dir="${reports.dir}/findbugs" />
		<findbugs home="${findbugs.home}"
				output="xml"
				outputFile="${reports.dir}/findbugs/catroid_findbugs.xml" 
				excludeFilter="build_findbugs_excludes.xml" >
			<auxClasspath>
				<pathelement location="${android.sdk.platform}/${android.sdk.version}/android.jar" />
				<fileset dir="${catroid.libs}">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${catroid.excluded.classes}">
					<include name="**/*.classes" />
				</fileset>
				<fileset dir="${abs.libs}">
					<include name="**/*.jar" />
				</fileset>
				<fileset dir="${abs.bin}">
					<include name="**/*.class" />
					<include name="**/*.jar" />
				</fileset>
			</auxClasspath>
			<fileset dir="${catroid.classes}">
					<include name="**/*.class" />
			</fileset>
		</findbugs>
	</target>
	
	<target name="checkstyle">
		<taskdef resource="checkstyletask.properties" classpath="${checkstyle.home}/checkstyle-5.6-all.jar" />
		<!-- run verification of installation-->
      <available file="${checkstyle.home}/checkstyle-all-5.6.jar"
                   property="checkstyle.available" />
		<mkdir dir="${reports.dir}/checkstyle" />
		<checkstyle config="/home/catrobat/Jenkins/customScripts/checkstyle.xml"
			failOnViolation="false">
			<formatter type="xml"
				tofile="${reports.dir}/checkstyle/catroid_checkstyle.xml" />
			<fileset dir="/home/catrobat/jenkins_slave2/workspace/Catroid-Find-Bugs/catroid/src" includes="**/*.java" />
			<fileset dir="/home/catrobat/jenkins_slave2/workspace/Catroid-Find-Bugs/catroidUiTest/src" includes="**/*.java" />
			<fileset dir="/home/catrobat/jenkins_slave2/workspace/Catroid-Find-Bugs/catroidTest/src" includes="**/*.java" />
			<fileset dir="/home/catrobat/jenkins_slave2/workspace/Catroid-Find-Bugs/catroidSourceTest/src" includes="**/*.java" />
		</checkstyle>
	</target>
</project>
